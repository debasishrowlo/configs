" {{{
    source $VIMRUNTIME/vimrc_example.vim

    set diffexpr=MyDiff()
    function! MyDiff()
      let opt = '-a --binary '
      if &diffopt =~ 'icase' | let opt = opt . '-i ' | endif
      if &diffopt =~ 'iwhite' | let opt = opt . '-b ' | endif
      let arg1 = v:fname_in
      if arg1 =~ ' ' | let arg1 = '"' . arg1 . '"' | endif
      let arg1 = substitute(arg1, '!', '\!', 'g')
      let arg2 = v:fname_new
      if arg2 =~ ' ' | let arg2 = '"' . arg2 . '"' | endif
      let arg2 = substitute(arg2, '!', '\!', 'g')
      let arg3 = v:fname_out
      if arg3 =~ ' ' | let arg3 = '"' . arg3 . '"' | endif
      let arg3 = substitute(arg3, '!', '\!', 'g')
      if $VIMRUNTIME =~ ' '
        if &sh =~ '\<cmd'
          if empty(&shellxquote)
            let l:shxq_sav = ''
            set shellxquote&
          endif
          let cmd = '"' . $VIMRUNTIME . '\diff"'
        else
          let cmd = substitute($VIMRUNTIME, ' ', '" ', '') . '\diff"'
        endif
      else
        let cmd = $VIMRUNTIME . '\diff'
      endif
      let cmd = substitute(cmd, '!', '\!', 'g')
      silent execute '!' . cmd . ' ' . opt . arg1 . ' ' . arg2 . ' > ' . arg3
      if exists('l:shxq_sav')
        let &shellxquote=l:shxq_sav
      endif
    endfunction
" }}}

" Misc {{{
    " auto reload files as they change on disk
    set autoread

    " redraw only when need to
    set lazyredraw

    " make the search case sensitive if uppercase letter available
    set ignorecase
    set smartcase

    " highlight matches
    set hlsearch

    " turn off search highlight
    set nohlsearch

    " prevent creating swap file on save
    set noswapfile

    " prevent creating backup file on save
    set nobackup
    set nowritebackup

    " prevent creating undo file on save
    set noundofile

    " do not automatically wrap on load
    set nowrap

    " do not automatically wrap text when typing
    set formatoptions-=t

    " do not automatically insert the current comment leader after hitting <Enter> in Insert mode.
    set formatoptions-=r

    " do not automatically insert the current comment leader after hitting 'o' or 'O' in Normal mode.
    set formatoptions-=o

    " set leader to comma
    let mapleader=","

    " open the new file on the right when splitting a view
    set splitright

    " copy to clipboard
    noremap <Leader>y "+y

    " paste from clipboard
    noremap <Leader>p "+p

    "highlight current line
    set cursorline
" }}}

" Folding {{{
    " enable folding
    set foldenable

    " open most folds by default
    set foldlevelstart=10

    " set most number of folds allowed
    set foldnestmax=10

    " fold based on the indent level
    set foldmethod=indent

    " enable modelines (used in this file on the last line)
    set modelines=1

    " close folds having one screen line
    set fml=0

    " space key opens/closes folds
    nnoremap <space> za

    " set foldlevel to 0
    nnoremap <leader>0 :set foldlevel=0<CR>

    " set foldlevel to 1
    nnoremap <leader>1 :set foldlevel=1<CR>

    " set foldlevel to 2
    nnoremap <leader>2 :set foldlevel=2<CR>

    " set foldlevel to 3
    nnoremap <leader>3 :set foldlevel=3<CR>

    " set foldlevel to 4
    nnoremap <leader>4 :set foldlevel=4<CR>

    " set foldlevel to 5
    nnoremap <leader>5 :set foldlevel=5<CR>
" }}}

" Spaces and Tabs {{{
    " number of visual spaces per TAB
    set tabstop=4

    " number of spaces in tab when editing
    set softtabstop=4

    " set the number of spaces to shift when indenting in normal mode
    set shiftwidth=4

    " convert tabs to spaces
    set expandtab
" }}}

" UI {{{
    " show relative line numbers
    set relativenumber

    " Hide Menu Bar
    set guioptions -=m 

    " Hide Tool Bar
    set guioptions -=T

    " Hide left scrollbar
    set guioptions-=l

    " Hide left scrollbar when windows are vertically split
    set guioptions-=L

    " set editor font
    set guifont=consolas:h14:b
" }}}

" Movement Keymaps {{{
    " map semicolon to colon
    map ; :

    " jk is escape
    inoremap jk <esc>

    " JK is escape
    inoremap JK <esc>

    " Jump to the window left to the current window
    map <C-h> <C-w>h

    " Jump to the window right to the current window
    map <C-l> <C-w>l

    " Jump to the window above the current window
    map <C-k> <C-w>k

    " Jump to the window below the current window
    map <C-j> <C-w>j
" }}}

" Tab Keymaps {{{
    " Open new tab
    map <Leader>t :tabnew<CR>

    " Move to next tab
    map tj :tabnext<CR>

    " Move to previous tab
    map tk :tabprev<CR>

    " Move current tab to the left
    map th :tabm -1<CR>

    " Move current tab to the right
    map tl :tabm +1<CR>

    " close tabs to the right
    map <Leader>ta :.+1,$tabdo :tabc<CR>
" }}}

" Combination Keymaps {{{
    " reload vim to apply vimrc updates
    map <F5> :source $MYVIMRC<CR>

    " open vimrc
    map <F2> :e $MYVIMRC<CR>

    " find and replace
    map <Leader>r :.,$s/

    " copy file path
    " Convert slashes to backslashes for Windows.
    if has('win32')
      nmap ,fs :let @*=substitute(expand("%"), "/", "\\", "g")<CR>
      nmap ,fl :let @*=substitute(expand("%:p"), "/", "\\", "g")<CR>

      " This will copy the path in 8.3 short format, for DOS and Windows 9x
      nmap ,f8 :let @*=substitute(expand("%:p:8"), "/", "\\", "g")<CR>
    else
      nmap ,fs :let @*=expand("%")<CR>
      nmap ,fl :let @*=expand("%:p")<CR>
    endif
" }}}

" External Packages {{{
    " Specify a directory for plugins
    " - For Neovim: stdpath('data') . '/plugged'
    " - Avoid using standard Vim directory names like 'plugin'
    call plug#begin('~/.vim/plugged')

    Plug 'ayu-theme/ayu-vim'
    Plug 'easymotion/vim-easymotion'
    Plug 'honza/vim-snippets'
    Plug 'isruslan/vim-es6'
    Plug 'jparise/vim-graphql'
    Plug 'kien/ctrlp.vim'
    Plug 'leafgarland/typescript-vim',
    Plug 'MaxMEllon/vim-jsx-pretty'
    Plug 'morhetz/gruvbox'
    Plug 'neoclide/coc.nvim', {'branch': 'release'}
    Plug 'Raimondi/delimitMate'
    Plug 'scrooloose/nerdcommenter'
    Plug 'scrooloose/nerdtree'
    Plug 'terryma/vim-multiple-cursors'
    Plug 'tpope/vim-fugitive'

    " Initialize plugin system
    call plug#end()
" }}}

" External package settings {{{
    " NERDTree - Toggle file explorer
    map <leader>e :NERDTreeToggle<CR>

    " NERDTree - Find the current file in file explorer
    map <leader>f :NERDTreeFind<CR>

    " NERDTree - Show hidden files in file explorer
    let NERDTreeShowHidden=1

    " ctrlp - Show dotfiles and dotdirs in file finder
    let ctrlp_show_hidden=1

    " ctrlp - Ignore loading provided folders to improve startup time
    let g:ctrlp_custom_ignore = '\v[\/](\.git|node_modules|vendor)$'

    " ctrlp - Only search within the current working directory
    let g:ctrlp_working_path_mode = ''

    " easy-motion
    " Move to word
    map  <Leader>w <Plug>(easymotion-bd-w)
    nmap <Leader>w <Plug>(easymotion-overwin-w)

    " coc settings
    " use enter to confirm completion
    inoremap <silent><expr> <cr> pumvisible() ? coc#_select_confirm() : "\<C-g>u\<CR>\<c-r>=coc#on_enter()\<CR>"
" }}}

" File specific settings {{{
    " Set the filetype based on the file's extension, overriding any
    " filetype' that has already been set
    au BufRead,BufNewFile *.tsx set filetype=typescriptreact
    au BufRead,BufNewFile *.ts set filetype=typescript

    autocmd Filetype html            setlocal softtabstop=2 shiftwidth=2 tabstop=2 expandtab
    autocmd Filetype css             setlocal softtabstop=2 shiftwidth=2 tabstop=2 expandtab
    autocmd Filetype javascript      setlocal softtabstop=2 shiftwidth=2 tabstop=2 expandtab
    autocmd Filetype typescript      setlocal softtabstop=2 shiftwidth=2 tabstop=2 expandtab
    autocmd Filetype typescriptreact setlocal softtabstop=2 shiftwidth=2 tabstop=2 expandtab
    autocmd Filetype json            setlocal softtabstop=2 shiftwidth=2 tabstop=2 expandtab
    autocmd Filetype text            setlocal softtabstop=2 shiftwidth=2 tabstop=2 expandtab linebreak wrap
" }}}

" Colors {{{
    " set default colorscheme
    colorscheme gruvbox

    "set line number colors
    highlight LineNr guifg=#718096
" }}}

" vim:foldlevel=0
